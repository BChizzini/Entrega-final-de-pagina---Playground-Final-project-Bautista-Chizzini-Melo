{% extends 'base.html' %}
{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <h1>{{ car.marca }} {{ car.modelo }}</h1>
        {% if car.imagen %}
            <img src="{{ car.imagen.url }}" class="img-fluid mb-3" alt="{{ car.modelo }}">
        {% endif %}
        <p>{{ car.descripcion }}</p>
        <p class="text-muted">Publicado el {{ car.fecha_publicacion }}</p>
        
        
        {% if user.is_authenticated %}
            <button id="like-btn" data-car-id="{{ car.pk }}" class="btn btn-danger">Like ({{ car.like_set.count }})</button>
        {% else %}
            <p><a href="{% url 'login' %}">Inicia sesi√≥n</a> para dar like</p>
        {% endif %}

        <form method="post" action="{% url 'comment_car' car.pk %}" class="mt-3">
            {% csrf_token %}
            <textarea name="content" class="form-control" placeholder="Escribe un comentario..."></textarea>
            <button type="submit" class="btn btn-primary mt-2">Comentar</button>
        </form>
        
       
        {% if user.is_authenticated and user.is_superuser or user.is_authenticated and car.autor == user %}
            <div class="mt-3">
                <a href="{% url 'car_update' car.pk %}" class="btn btn-warning">Editar Auto</a>
                <a href="{% url 'car_delete' car.pk %}" class="btn btn-danger">Borrar Auto</a>
            </div>
        {% endif %}
        
        <h3 class="mt-4">Comentarios</h3>
        {% for comment in car.comment_set.all %}
            <div class="border p-2 mb-2">
                <strong>{{ comment.user.username }}</strong>: {{ comment.content }}
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}